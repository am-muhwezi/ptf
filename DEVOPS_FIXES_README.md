# DevOps Fixes Checklist for Junior Developer

## 🚨 Current Issues & Solutions

### Issue 1: Root Domain 404 Error
**Problem:** `https://paulstropicalfitness.fit/` shows Vercel 404 but `https://www.paulstropicalfitness.fit/` works

**Root Cause:** DNS configuration mismatch between root domain and www subdomain

**Solutions (Pick One):**
- [ ] **Option A: Fix DNS Records**
  ```bash
  # Set these DNS records in DigitalOcean DNS:
  A     @              134.209.31.145
  CNAME www            @
  ```

- [ ] **Option B: Redirect Root to WWW** (Recommended)
  ```bash
  # Add nginx redirect on droplet:
  server {
      listen 80;
      server_name paulstropicalfitness.fit;
      return 301 https://www.paulstropicalfitness.fit$request_uri;
  }
  ```

### Issue 2: SPA 404 on Refresh
**Problem:** React SPA shows 404 when refreshing on routes like `/members`, `/payments`

**Root Cause:** Static hosting doesn't handle client-side routing

**Solutions:**
- [ ] **Option A: Add _redirects file to static build**
  ```
  # In frontend/dist/_redirects
  /*    /index.html   200
  ```

- [ ] **Option B: Serve from Droplet with nginx**
  ```nginx
  # /etc/nginx/sites-available/ptf
  server {
      listen 80;
      server_name www.paulstropicalfitness.fit;
      root /home/ptfadmin/project-ptf/frontend/dist;
      
      location / {
          try_files $uri $uri/ /index.html;
      }
      
      location /api/ {
          proxy_pass http://localhost:8000/;
      }
  }
  ```

### Issue 3: Performance Analysis
**Question:** Will serving from droplet increase speed?

**Analysis:**
- [ ] **Current Setup:** Static (CDN) + API (Droplet) = ⚡ Fast static, 🐌 Cross-origin API calls
- [ ] **Droplet Only:** Static + API (Same server) = 🚀 Faster API, 📍 Single location
- [ ] **Recommended:** Keep current + fix DNS = Best of both worlds

## 🔧 Quick Implementation Steps

### Step 1: Fix Root Domain (5 minutes)
```bash
# SSH to droplet
ssh ptfadmin@134.209.31.145

# Install nginx if not present
sudo apt update && sudo apt install nginx

# Create redirect config
sudo nano /etc/nginx/sites-available/redirect
```

Add this config:
```nginx
server {
    listen 80;
    server_name paulstropicalfitness.fit;
    return 301 https://www.paulstropicalfitness.fit$request_uri;
}
```

```bash
# Enable config
sudo ln -s /etc/nginx/sites-available/redirect /etc/nginx/sites-enabled/
sudo nginx -t && sudo systemctl reload nginx
```

### Step 2: Fix SPA Routing (2 minutes)
```bash
# Add to your static site deployment
echo "/*    /index.html   200" > frontend/dist/_redirects
```

### Step 3: SSL Setup (10 minutes)
```bash
# Install certbot
sudo apt install certbot python3-certbot-nginx

# Get SSL for root domain
sudo certbot --nginx -d paulstropicalfitness.fit
```

## ✅ Testing Checklist
- [ ] `https://paulstropicalfitness.fit/` redirects to `https://www.paulstropicalfitness.fit/`
- [ ] Refresh on `/members` page doesn't show 404
- [ ] Refresh on `/payments` page doesn't show 404
- [ ] API calls from frontend work correctly
- [ ] SSL certificate works for both domains

## 🎯 Performance Recommendation
**Keep current architecture** (Static CDN + Droplet API) but fix the issues above. This gives you:
- ⚡ Global CDN for static assets
- 🔒 Proper SSL/TLS
- 🚀 Fast API responses
- 💰 Cost effective

---
*Generated by Senior DevOps Engineer for Junior Developer*
*Priority: High - Affects user experience*